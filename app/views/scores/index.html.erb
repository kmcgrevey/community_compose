<h1><%= @score.title %></h1>

<div id="embed-container"></div>
<%# <button id="export-xml" class="btn-cta-site">Submit Changes</button> %>
<%= button_to 'Submit Changes', "/scores/#{@score.id}", method: :patch, id: 'export-xml' %>
<script src="https://prod.flat-cdn.com/embed-js/v1.3.0/embed.min.js"></script>
<script>
  var container = document.getElementById("embed-container");
  var embed = new Flat.Embed(container, {
    "width": "100%",
    "height": "450",
    "score": "<%= @score.id %>",
    "embedParams": {
      "mode": "edit",
      "branding": false,
      "appId": "5ecd978ef0aa2b501cf8cf25",
      "controlsPosition": "top"
    },
  });

  document.getElementById('export-xml').addEventListener('click', function () {
    embed.getMusicXML({ compressed: true }).then(function (buffer) {
    // var blobUrl = window.URL.createObjectURL(new Blob(buffer), {
      type: 'spplication/vnd.recordare.musicxml+xml'
      });
    });
  // });
  var data = new FormData();
   data.append(blobUrl);
  return data;
</script>
